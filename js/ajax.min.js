var timezone;var app=angular.module("myApp",[]);app.controller("myCtrl",function(a,b){a.theDay=moment().format();a.theTime=moment.tz(timezone).format("h:mm:ss A");b(function(){a.theTime=a.theTime=moment.tz(timezone).format("h:mm:ss A")},1000)});$(document).ready(function(){var h={us:{systemName:"us",temperature:"°F",speed:"mph",distance:"mi."},si:{systemName:"si",temperature:"°C",speed:"km/h",distance:"km"}};var f=h[$("input[name='units']:checked").val()];var a;var m={};var n=$("form[id=selectedUnits] > input");for(var e=0;e<n.length;e++){n[e].onclick=function(){f=h[this.value];if(typeof a!=="undefined"){g()}}}$("#myButton").click(function(i){i.preventDefault();if($("#address").val()===""){return}document.activeElement.blur();setTimeout(d,1500,"js-hiddenContent");$.ajax({url:"php/coordinates.php",type:"GET",data:{address:$("#address").val()},dataType:"json",success:function(o){l(o)},error:function(q,p,o){console.log(q);console.log("Details: "+p+"\nError:"+o)}})});var d=function(i){$("."+i).fadeIn(300);$(".viewpanel").matchHeight()};var l=function(i){if(typeof i.results[0]==="undefined"){return}m.latitude=i.results[0].geometry.location.lat;m.longitude=i.results[0].geometry.location.lng;k("location-info",i);g()};var g=function(){$.ajax({url:"php/forecast.php",type:"GET",data:{lat:m.latitude,lon:m.longitude,units:f.systemName},dataType:"json",success:function(i){j(i);a=i},error:function(p,o,i){console.log(p);console.log("Details: "+o+"\nError:"+i)}})};var j=function(i){c("js-currently");b("js-currently",i);c("js-tonight");b("js-tonight",i);c("js-tomorrow");b("js-tomorrow",i)};var c=function(i){classSpanId=[];$("."+i+" span").each(function(){classSpanId.push($(this).attr("id"))});return classSpanId};var k=function(i,o){$("#location").html(o.results[0].formatted_address)};var b=function(o,r){var q=c(o);var i=moment().tz("Etc/UTC");timezone=r.timezone;var p=i.tz(r.timezone).format("H");if(o==="js-currently"){str="currently"}else{if(o==="js-tonight"){dataIndex=24-p;str="hourly.data."+dataIndex}else{if(o==="js-tomorrow"){dataIndex=36-p;str="hourly.data."+dataIndex}}}$.each(q,function(s,t){dataPoint=str+"["+t+"]";switch(t){case"icon":$("."+o+" #icon").html('<img src="img/'+Object.byString(r,dataPoint)+'.png" alt="'+Object.byString(r,dataPoint)+'"  />');break;case"temperature":case"apparentTemperature":attribute=Object.byString(r,dataPoint);$("."+o+" #"+t).html(attribute.toFixed(0)+" "+f.temperature);break;case"precipProbability":attribute=Math.round(Object.byString(r,dataPoint)*100);$("."+o+" #"+t).html(attribute+"%");break;case"windSpeed":attribute=Math.round(Object.byString(r,dataPoint));if(f.systemName==="si"){attribute=Math.round(attribute*3.6)}$("."+o+" #"+t).html(attribute+" "+f.speed);break}})};Object.byString=function(u,t){t=t.replace(/\[(\w+)\]/g,".$1");t=t.replace(/^\./,"");var p=t.split(".");for(var r=0,v=p.length;r<v;++r){var q=p[r];if(q in u){u=u[q]}else{return}}return u}});